<div class="card card-manager"
     x-data="{
       cards: [],
       newCardName: '',
       newCardType: 'info',
       editingId: null,
       editName: '',
       cardData: null,
       init() {
         this.cardData = window.cardData.cards;
         this.loadCards();
       },
       async loadCards() {
         this.cards = await this.cardData.getCards();
       },
       async addCard() {
         if (!this.newCardName.trim()) return;
         await this.cardData.addCard(this.newCardName, this.newCardType);
         this.newCardName = '';
         await this.loadCards();
       },
       async deleteCard(id, name) {
         if (!confirm(`Are you sure you want to delete card "${name}"?`)) return;
         await this.cardData.deleteCard(id);
         await this.loadCards();
       },
       startEdit(id, name) {
         this.editingId = id;
         this.editName = name;
       },
       async saveEdit(id) {
         if (!this.editName.trim()) return;
         await this.cardData.renameCard(id, this.editName);
         this.editingId = null;
         this.editName = '';
         await this.loadCards();
       },
       cancelEdit() {
         this.editingId = null;
         this.editName = '';
       }
     }"
     x-init="init">
  <div class="cards-container">
    <template x-for="card in cards" :key="card.id">
      <div class="card-wrapper">
        <div class="card-header">
          <template x-if="editingId !== card.id">
            <div class="card-title">
              <span x-text="card.name"></span>
              <div class="card-actions">
                <button @click="startEdit(card.id, card.name)" class="btn-edit">
                  <i class="fas fa-edit"></i>
                </button>
                <button @click="deleteCard(card.id, card.name)" class="btn-delete">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
          </template>
          <template x-if="editingId === card.id">
            <div class="card-edit">
              <input type="text" 
                     x-model="editName" 
                     @keyup.enter="saveEdit(card.id)"
                     @keyup.escape="cancelEdit">
              <div class="edit-actions">
                <button @click="saveEdit(card.id)" class="btn-save">Save</button>
                <button @click="cancelEdit" class="btn-cancel">Cancel</button>
              </div>
            </div>
          </template>
        </div>
        <div class="card-content" :data-index="card.id">
          <div hx-get="/cards/info/template" hx-trigger="load" hx-swap="outerHTML"></div>
        </div>
      </div>
    </template>
  </div>

  <div class="add-card">
    <input type="text" 
           x-model="newCardName" 
           placeholder="New card name" 
           @keyup.enter="addCard">
    <select x-model="newCardType">
      <option value="info">Info Card</option>
    </select>
    <button @click="addCard" class="btn-add">Add Card</button>
  </div>
</div> 