<!-- src/cards/info/info.html -->
<div class="card info-card"
     x-data="{ 
       messages: [],
       inputValue: '',
       cardId: null,
       cardData: window.cardData.info,
       async init() {
         const wrapper = $el.closest('.card-wrapper');
         if (!wrapper) {
           console.error('No card-wrapper found!');
           return;
         }
         this.cardId = wrapper.dataset.index;
         await this.loadMessages();
       },
       async submitMessage() {
         if (!this.inputValue.trim()) return;
         await this.cardData.handleKvUpdate(this.cardId, this.inputValue);
         this.inputValue = '';
         await this.loadMessages();
       },
       async deleteMessage(messageId) {
         await this.cardData.handleKvDelete(this.cardId, messageId);
         await this.loadMessages();
       },
       async loadMessages() {
         if (!this.cardId || !this.cardData) return;
         this.messages = await this.cardData.loadCardMessages(this.cardId);
         this.messages.sort((a, b) => b.timestamp - a.timestamp);
       }
     }"
     x-init="init">
  <div class="info-content">
    <div class="message-container">
      <template x-for="message in messages" :key="message.id">
        <div class="message">
          <div class="message-text" x-text="message.text"></div>
          <div class="message-meta">
            <span class="message-time" x-text="new Date(message.timestamp).toLocaleString()"></span>
            <button class="delete-btn" @click="deleteMessage(message.id)">Ã—</button>
          </div>
        </div>
      </template>
    </div>

    <form @submit.prevent="submitMessage" class="input-container">
      <input type="text" 
             x-model="inputValue" 
             placeholder="Enter a message">
      <button type="submit" class="submit-btn">Submit</button>
    </form>
  </div>
</div>